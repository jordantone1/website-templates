<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Admin Setup - Scheduling Template</title>
  <script>
    // Function to handle Google Sheet URL submission
    function linkGoogleSheet() {
      const sheetURL = document.getElementById('sheet-url').value;
      const sheetID = extractSheetID(sheetURL);

      if (sheetID) {
        // Insert the extracted Sheet ID into the booking system dynamically
        updateClientSite(sheetID);
        alert('Google Sheet successfully linked!');
      } else {
        alert('Please enter a valid Google Sheet URL.');
      }
    }

    // Extract the Google Sheet ID from the provided URL
    function extractSheetID(url) {
      const regex = /\/d\/(.*?)(?:\/|$)/;
      const match = url.match(regex);
      return match ? match[1] : null;
    }

    // Function to update the client-facing site dynamically
    function updateClientSite(sheetID) {
      // This creates a script element that integrates the Google Sheet into the index.html page
      const script = document.createElement('script');
      script.type = 'text/javascript';
      script.textContent = `
        const googleSheetID = '${sheetID}';
        function fetchBookings() {
          const url = 'https://sheets.googleapis.com/v4/spreadsheets/' + googleSheetID + '/values/Sheet1?key=YOUR_API_KEY';
          fetch(url)
            .then(response => response.json())
            .then(data => {
              console.log('Booking Data:', data);
              // Logic to block off booked slots can be added here
            })
            .catch(error => console.error('Error fetching data:', error));
        }
        fetchBookings();
      `;
      document.body.appendChild(script);
    }
  </script>
</head>
<body>
  <h1>Admin Setup</h1>
  <p>Paste your Google Sheet link below to link your booking system:</p>
  <input type="text" id="sheet-url" placeholder="Paste your Google Sheet URL here" style="width: 300px;">
  <button onclick="linkGoogleSheet()">Confirm & Link</button>
</body>
</html>
