<script>
  let currentDisplayedMonth = new Date();

  function generateCalendar() {
    const calendarDiv = document.getElementById('calendar-dates');
    calendarDiv.innerHTML = '';
    const today = new Date();
    const maxBookingDate = new Date();
    maxBookingDate.setMonth(maxBookingDate.getMonth() + 3);
    const currentMonth = new Date(currentDisplayedMonth.getFullYear(), currentDisplayedMonth.getMonth(), 1);
    const lastDate = new Date(currentDisplayedMonth.getFullYear(), currentDisplayedMonth.getMonth() + 1, 0);

    // Update header with current month and year
    document.getElementById('calendar-month-year').innerText = `${currentMonth.toLocaleString('default', { month: 'long' })} ${currentMonth.getFullYear()}`;

    // Add weekday headers
    const weekdays = ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'];
    const headerRow = document.createElement('div');
    headerRow.classList.add('calendar-header');
    weekdays.forEach(day => {
      const dayElement = document.createElement('div');
      dayElement.innerText = day;
      headerRow.appendChild(dayElement);
    });
    calendarDiv.appendChild(headerRow);

    let date = new Date(currentMonth);
    date.setDate(1 - date.getDay());

    while (date <= lastDate || date.getDay() !== 0) {
      const dateStr = date.toISOString().split('T')[0];
      const dayButton = document.createElement('button');
      dayButton.innerText = date.getDate();

      if (
        date < new Date(today.getTime() + 24 * 60 * 60 * 1000) ||
        date > maxBookingDate ||
        businessDetails.availability[dateStr] ||
        date.getMonth() !== currentDisplayedMonth.getMonth()
      ) {
        dayButton.disabled = true;
        dayButton.style.backgroundColor = '#ccc';
      } else {
        dayButton.onclick = function () {
          selectDate(dateStr);
        };
      }

      calendarDiv.appendChild(dayButton);
      date.setDate(date.getDate() + 1);
    }
  }

  function previousMonth() {
    currentDisplayedMonth.setMonth(currentDisplayedMonth.getMonth() - 1);
    generateCalendar();
  }

  function nextMonth() {
    currentDisplayedMonth.setMonth(currentDisplayedMonth.getMonth() + 1);
    generateCalendar();
  }
</script>

<style>
  #calendar-controls {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 10px;
  }
  .nav-arrow {
    cursor: pointer;
    font-size: 1.5rem;
    padding: 5px 10px;
  }
</style>

<div id="calendar">
  <div id="calendar-controls">
    <span class="nav-arrow" onclick="previousMonth()">&#8592;</span>
    <h3 id="calendar-month-year"></h3>
    <span class="nav-arrow" onclick="nextMonth()">&#8594;</span>
  </div>
  <h3>Select a Date</h3>
  <div id="calendar-dates"></div>
  <h3 id="selected-date"></h3>
  <div id="time-slots"></div>
</div>

 
